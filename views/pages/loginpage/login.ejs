<!DOCTYPE html>
<html lang="zh-Hant-TW">

<head>
    <%- include('../../partials/head') -%>
        <%- include('../../partials/styles') -%>
</head>

<body>
    <%- include('../../partials/navbar') -%>

        <form class="card" style="width:90%;margin:0 auto;">
            <div class="container" style="margin: 0 auto; width:50%;">
                <div class="form-group">
                    <h1 style="border: 3px solid black;">Login or Register</h1>
                    <label for="email">請輸入Email :</label>
                    <input class="form-control" type="email" id="email" name="email" placeholder="xxx@yyy.com" required>
                </div>
                <div class="form-group">
                    <label for="password">請輸入密碼 :</label>
                    <input class="form-control" type="password" id="pwd" name="pwd" required>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary" id="login_submit"> Login </button>
                    <a href="register" type="submit" class="btn btn-primary"> Register </a>
                    <div id="msg" style="color: whitesmoke;"></div>
                </div>
            </div>
        </form>
        <%- include('../../partials/footer') -%>
        <%- include('../../partials/scripts') -%>
            <script>
                $("#login_submit").click(function () {
                    var email = $('#email').val();
                    var pwd = $('#pwd').val();
                    $.ajax({
                        type: "GET",
                        url: "http://localhost:1214/account/register/new",
                        dataType: "json",
                        success: function (data) {
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].email == email && data[i].pwd == pwd) {
                                    alert(`welcome back ${data[i].username}`);
                                    window.location.href = "/";
                                    break;
                                } else {
                                    alert("密碼錯誤或請註冊");
                                    break;
                                }
                            }
                        }
                    })
                })
            </script>
</body>

</html>